<p-toolbar
  class="bg-primary-500 text-primary-50 w-full"
>
  <ng-template #start>
    <div class="flex items-center md:gap-6">
      <!-- Mobile Menu Toggle -->
      <p-button
        icon="pi pi-bars"
        [text]="true"
        [rounded]="true"
        severity="secondary"
        size="small"
        class="sm:hidden"
        (onClick)="toggleSidebar()">
      </p-button>
      
      <!-- Logo Section -->
      <div class="flex items-center">
        <div class="flex items-center px-2">
          <div class="w-[40px]">
            <img ngSrc="favicon-32x32.png" width="40" height="40" placeholder="Talkio" alt="Talkio Logo" />
          </div>
          <span class="ml-2 font-semibold text-2xl dark:text-white">
            Talkio
          </span>
        </div>
      </div>

      <!-- Navigation Links -->
      <div class="hidden sm:flex items-center gap-2">
        <div class="relative">
          <p-button
            label="Messages"
            icon="pi pi-comments"
            [text]="true"
            routerLink="/messenger"
            routerLinkActive="active-nav"
            severity="secondary"
            size="small"
            styleClass="nav-button border-none">
          </p-button>
          @if (totalUnreadCount() > 0) {
            <p-badge 
              [value]="totalUnreadCount().toString()" 
              severity="danger" 
              class="absolute -top-2 -right-1"
              size="small"
            ></p-badge>
          }
        </div>
        
        <p-button
          label="Profile"
          icon="pi pi-user"
          [text]="true"
          routerLink="/profile"
          routerLinkActive="active-nav"
          severity="secondary"
          size="small"
          styleClass="nav-button border-none">
        </p-button>
      </div>
    </div>
  </ng-template>

  <ng-template #end>
    <!-- User Avatar -->
    <div class="profile-avatar-container">
      @if (user()?.avatarUrl) {
        <p-avatar
          [image]="user()?.avatarUrl"
          size="large"
          shape="circle"
          class="hover:scale-105 transition-transform duration-200"
          #menuTarget
        ></p-avatar>
      } @else {
        <p-avatar
          [label]="user()?.username?.charAt(0)?.toUpperCase() || 'U'"
          size="large"
          shape="circle"
          class="hover:scale-105 transition-transform duration-200"
          #menuTarget
        ></p-avatar>
      }
    </div>
  </ng-template>
</p-toolbar>

<!-- Mobile Sidebar -->
<app-mobile-sidebar 
  [user]="user()" 
  [visible]="sidebarVisible()"
  (visibleChange)="sidebarVisible.set($event)">
</app-mobile-sidebar>

<!-- Toast and Confirmation Dialog -->
<p-toast></p-toast>
<p-confirmDialog></p-confirmDialog>
